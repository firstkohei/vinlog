<div class="album py-5">
  <div class="container">
    <div class="row">
      <% wines.each do |wine| %>
      <div class="col-md-4">
        <div class="card mb-4 shadow-sm">
          <%= image_tag wine.image.to_s %>
          <div class="card-body">
            <p class="card-text"><%= link_to wine.name, wine_path(wine) %></p>
            <div class="d-flex justify-content-between align-items-center">
              <div class="form-group row">
                <% if current_user.favorite?(wine) %>
                  <%= form_with(model: current_user.favorites.find_by(wine_id: wine.id), local: true, method: :delete) do |f| %>
                    <%= hidden_field_tag :wine_id, wine.id %>
                    <%= f.submit 'Unlike', class: 'btn btn-danger btn-sm' %>
                  <% end %>
                <% else %>
                  <%= form_with(model: current_user.favorites.build, local: true) do |f| %>
                    <%= hidden_field_tag :wine_id, wine.id %>
                    <%= f.submit 'Like', class: 'btn btn-primary btn-sm' %>
                  <% end %>
                <% end %>
                <% if current_user == wine.user %>
                  <%= link_to "Delete", wine, method: :delete, data: { confirm: "You sure?" }, class: 'btn btn-danger btn-sm' %>
                <% end %>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <% if current_user != wine.user %>
                  <small class="text-muted">投稿者：<%= link_to wine.user.name, user_path(wine.user) %></small>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
      <% end %>
    </div>
  </div>
</div>